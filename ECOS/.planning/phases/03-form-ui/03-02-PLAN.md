---
phase: 03-form-ui
plan: 02
type: execute
---

<objective>
Add the security agreement content display and acknowledgment sections to the form.

Purpose: The security requirements from the original ECOS PDF (pages 9-11) are the core content signers agree to. This plan renders that content in a clean, readable format with per-section acknowledgment checkboxes — transforming a wall of PDF text into an interactive web experience.
Output: Security requirements rendered in collapsible sections with acknowledgment checkboxes that track what the user has read.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior plan in this phase:
@.planning/phases/03-form-ui/03-01-SUMMARY.md

# Prior phase summaries:
@.planning/phases/01-foundation/01-03-SUMMARY.md

# Key source files:
@src/components/form/AgreementForm.jsx
@src/components/ui/Card.jsx
@src/components/ui/Checkbox.jsx
@src/components/ui/SectionHeader.jsx
@src/components/ui/Alert.jsx
@src/context/RoleContext.jsx

# Reference for content:
@~/Documents/ecos-modernization-pitch.md (see "Streamlined Content" table and "What the Signer Sees" section)

**Tech stack available:** React 18, Tailwind CSS 3
**Established patterns:** atomic-component-library, Card for content sections, Checkbox with description prop
**Constraining decisions:**
- Phase 01-03: No clsx/twMerge — plain string concatenation
- PROJECT.md: "Security requirements (pages 9-11) shown in full — this is the core agreement"
- PROJECT.md: "User administrator responsibilities (page 6) shown conditionally for admin-level access only"
- PROJECT.md: "Streamlined agreement content: security requirements shown in full, administrative filler removed"
</context>

<tasks>

<task type="auto">
  <name>Task 1: Security requirements content and collapsible display</name>
  <files>src/data/securityRequirements.js, src/components/form/SecurityContentSection.jsx, src/components/form/CollapsibleSection.jsx</files>
  <action>
  **src/data/securityRequirements.js:** Create a data file exporting an array of security requirement sections. Each section has: id, title, content (string or array of bullet points), required (boolean — all true for standard sections). Content should represent realistic ECOS security agreement terms covering these topics (derived from the original PDF pages 9-11):

  1. **"Authorized Use"** — System access limited to official duties; no personal use; no unauthorized data access
  2. **"Data Confidentiality"** — All data accessed is confidential; no disclosure to unauthorized parties; comply with Information Practices Act (Civil Code 1798)
  3. **"Password & Authentication"** — Protect credentials; no sharing passwords; lock workstations when unattended; report compromised credentials immediately
  4. **"Incident Reporting"** — Report suspected security incidents immediately to supervisor and ISO; preserve evidence; cooperate with investigations
  5. **"Software & System Integrity"** — No unauthorized software installation; no circumventing security controls; no connecting unauthorized devices
  6. **"Remote Access & Telework"** — Secure home network; encrypted connections; no public WiFi for state data; physical security of devices
  7. **"Termination of Access"** — Access revoked upon separation, transfer, or role change; return all state equipment and data; obligation survives termination

  Also export an optional section for admin-level users:
  8. **"User Administrator Responsibilities"** (conditional — only shown when the form indicates admin-level access): Maintain accurate access records; conduct periodic access reviews; ensure subordinate compliance; report access anomalies

  Write content in plain, professional language — not legal boilerplate. Each section should be 3-6 bullet points. Keep it representative of what a real state security agreement would contain.

  **CollapsibleSection.jsx:** Create a reusable collapsible section component:
  - Props: title, children, defaultOpen (boolean, default false), id
  - Header row: chevron icon (▸/▾ using Unicode), title text, open/close toggle
  - Click header to expand/collapse with smooth transition (max-height or conditional render)
  - Styling: neutral-800 border, rounded, padding. Header bg slightly lighter (neutral-850/neutral-800)
  - When open: content visible below header with border-t separator
  - Keep it simple — CSS transition on max-height or just conditional render. Don't over-engineer.

  **SecurityContentSection.jsx:** Create the security content display:
  - Props: sections (from securityRequirements.js data), showAdminSection (boolean)
  - Uses SectionHeader with title "Security Requirements"
  - Renders an introductory paragraph: "By completing this agreement, you acknowledge that you have read, understand, and agree to comply with the following security requirements for ECOS system access."
  - Renders each section as a CollapsibleSection containing:
    - Section content as styled bullet points (ul with li items)
    - Clean typography: text-neutral-300 for content, text-white for section titles
  - First section defaults open, others collapsed
  - If showAdminSection is true, render the admin responsibilities section with an orange left border to visually distinguish it
  - Below all sections, show a count: "X of Y sections reviewed" based on which ones have been opened (track in local state — this is just UX polish, not validation)

  **Avoid:** Don't add checkboxes here — acknowledgment checkboxes are Task 2. Don't add form state management for acknowledgments yet. This task is purely content rendering.
  </action>
  <verify>
  Navigate to /ecosform/agreement, select a track:
  - Security Requirements section appears below department info
  - 7 collapsible sections visible (8 if admin-level flag were set)
  - First section expanded by default, others collapsed
  - Clicking a section header expands/collapses it
  - Content is readable, well-styled in dark theme
  - "X of Y sections reviewed" counter updates as sections are opened
  </verify>
  <done>Security requirements render in collapsible sections with professional content. Sections expand/collapse smoothly. Counter tracks opened sections.</done>
</task>

<task type="auto">
  <name>Task 2: Acknowledgment checkboxes per section</name>
  <files>src/components/form/AcknowledgmentSection.jsx, src/components/form/AgreementForm.jsx</files>
  <action>
  **AcknowledgmentSection.jsx:** Create the acknowledgment section that:
  - Props: sections (security requirements data), acknowledgments (object: { [sectionId]: boolean }), onChange handler, showAdminSection (boolean)
  - Uses SectionHeader with title "Acknowledgments"
  - Renders a Card containing one Checkbox per security section:
    - Label: "I have read and understand: [section title]"
    - Uses the Checkbox component from the design system
    - Checked state from acknowledgments[section.id]
    - onChange calls parent handler with section.id
  - If showAdminSection: include checkbox for admin responsibilities section
  - At the bottom, show progress: "X of Y acknowledged" with a colored indicator:
    - All acknowledged: text-green-500
    - Some: text-yellow-500
    - None: text-neutral-500
  - Include a "Select All" convenience link (text button, not a checkbox) that checks all boxes

  **AgreementForm.jsx update:**
  - Add acknowledgments to form state: initialize as empty object {}
  - Add handleAcknowledgment(sectionId) that toggles the boolean for that section
  - Wire SecurityContentSection and AcknowledgmentSection into the form flow:
    - After DepartmentInfoSection, render SecurityContentSection
    - After SecurityContentSection, render AcknowledgmentSection
  - Pass the security requirements data to both components
  - Determine showAdminSection: for now, always false (will be true when admin access groups are selected — wired in Plan 03-03)

  **Avoid:** Don't add form validation for "must acknowledge all" — that's Plan 03-03. Don't tie acknowledgments to form submission yet. Just get the checkboxes rendering and tracking state.
  </action>
  <verify>
  Navigate to /ecosform/agreement, select a track, scroll to acknowledgment section:
  - One checkbox per security section (7 total)
  - Checking/unchecking works, state persists while on page
  - Progress counter updates: "3 of 7 acknowledged"
  - "Select All" link checks all boxes
  - Checkboxes use existing Checkbox component styling (orange checkmark)
  </verify>
  <done>Acknowledgment checkboxes render for each security section with progress tracking. Select All works. State managed in AgreementForm.</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Security requirements data file contains 7 standard + 1 admin section
- [ ] Collapsible sections expand/collapse properly
- [ ] Acknowledgment checkboxes track per-section state
- [ ] Progress counters display correctly
- [ ] Select All works
- [ ] Dark theme styling consistent with design system
- [ ] No console errors or warnings
</verification>

<success_criteria>

- Security content renders in readable collapsible sections
- 7 standard sections + 1 conditional admin section defined
- Acknowledgment checkboxes track per-section agreement
- Progress indicators show completion state
- All tasks completed, all verification checks pass
</success_criteria>

<output>
After completion, create `.planning/phases/03-form-ui/03-02-SUMMARY.md`
</output>
