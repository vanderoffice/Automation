---
phase: 05-role-switcher-demo
plan: 03
type: execute
---

<objective>
Polish the demo experience with visual cues that guide executives through the three-party workflow, smooth transitions when switching roles, and a cohesive first-impression when landing on the app.

Purpose: The difference between "working prototype" and "impressive demo" is the polish layer. Guided hints help non-technical executives understand what they're seeing. Smooth transitions make role switching feel like a feature, not a hack. A strong landing experience sets the tone for the pitch.
Output: Demo mode banner with context hints, CSS transitions on role switch, polished landing state.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Key prior phase work:
@.planning/phases/05-role-switcher-demo/05-01-SUMMARY.md
@.planning/phases/05-role-switcher-demo/05-02-SUMMARY.md

# Source files:
@src/components/Layout.jsx
@src/components/Sidebar.jsx
@src/components/RoleSwitcher.jsx
@src/context/RoleContext.jsx
@src/pages/AgreementPage.jsx
@src/pages/WorkflowPage.jsx
@src/index.css

**Tech stack available:** React 18, react-router-dom@6, Tailwind CSS 3
**Established patterns:** vanderdev design system (dark bg, orange accents, fadeIn animations), Layout route with Outlet, useRole() hook
**Constraining decisions:**
- [01-03]: No clsx/twMerge — plain string concatenation
- [05-01]: RoleSwitcher in sidebar footer, all pages respond to role changes
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add demo mode context banner with role-aware hints</name>
  <files>src/components/DemoBanner.jsx, src/components/Layout.jsx</files>
  <action>
Create a DemoBanner component that provides contextual guidance based on current role and page:

1. **DemoBanner.jsx**: A slim, dismissable banner that appears at the top of the content area (inside Layout, above the Outlet):
   - Background: bg-orange-500/10 border border-orange-500/20 — subtle, on-brand
   - Contains a contextual hint message based on current role + current route
   - Small dismiss "x" button — uses sessionStorage to remember dismissal per-session (key: 'ecos_demo_banner_dismissed')
   - Re-shows when role changes (clear dismissal on role switch)

   Role + page hint messages:
   - Employee + /agreement: "You're viewing as an employee. Fill out and submit a new ECOS security agreement."
   - Employee + /workflow: "Your submitted agreements appear here. Once submitted, your manager reviews next."
   - Manager + /agreement: "As a manager, you can also submit your own agreement."
   - Manager + /workflow: "Agreements from your team are waiting for your signature. Review and sign below."
   - Admin + /agreement: "Admins can submit agreements too — the same form works for all roles."
   - Admin + /workflow: "After manager approval, agreements come to you for final sign-off."
   - Any + /dashboard: "The admin dashboard shows compliance status across all departments." (Phase 6 content)

   Use useRole() for role and useLocation() for pathname.

2. **Layout.jsx**: Add DemoBanner above the Outlet in the page content area:
   - Place it inside the `<div className="max-w-7xl mx-auto">` wrapper, before `<Outlet />`
   - Add mb-4 to the banner for spacing

Do NOT make the banner intrusive — it should enhance, not obstruct. Compact single line with icon + text + dismiss.
  </action>
  <verify>
- Banner appears with correct hint for each role+page combination
- Dismiss button hides the banner
- Switching roles re-shows the banner with updated hint
- Page navigation updates the hint text
- Banner styling is subtle and on-brand (orange tint, not screaming)
  </verify>
  <done>DemoBanner component shows contextual hints per role+page, dismissable per-session, re-shows on role change</done>
</task>

<task type="auto">
  <name>Task 2: Add transition effects and polish landing experience</name>
  <files>src/index.css, src/components/RoleSwitcher.jsx, src/pages/WorkflowPage.jsx, src/pages/AgreementPage.jsx</files>
  <action>
Polish transitions and first-impression:

1. **Role switch transition (index.css)**:
   - Add a CSS class `role-switching` that applies a brief opacity fade (opacity 0.6 → 1, 200ms) to the main content area
   - The RoleSwitcher component should add/remove this class to the content area on role switch (or use a state variable in RoleContext that pages can read)
   - Simpler approach: Add a `switching` state to RoleContext. When switchRole is called, set switching=true, do the switch, then set switching=false after 200ms via setTimeout. Pages wrap their content in a div with conditional opacity class.
   - Even simpler: Just add CSS transition on the existing `.animate-in` class that each page already uses. When role changes, the page component re-renders with fresh data — the existing fadeIn animation already provides visual feedback. Check if this is sufficient.
   - Evaluate: if the existing animate-in on page components already gives a good visual on role switch (because data reloads trigger re-render), then skip adding complexity. Only add explicit transition if the switch feels jarring.

2. **WorkflowPage empty state polish**:
   - Update the empty state message to be more demo-friendly: for employees, "Submit a new agreement to see it appear here" with a link/button to /agreement. For managers/admins, "No agreements are pending your review" with context about what would appear.
   - Add counts in the page header: "X pending, Y completed" as small badges next to the page title

3. **AgreementPage landing state**:
   - If the current employee already has a non-draft agreement for the current fiscal year, show a subtle notice: "You have an existing agreement for FY {year}" with a link to view it in /workflow
   - This is a nice-to-have — only implement if it doesn't require an additional API call that complicates the component. If it does, skip it.

4. **Overall CSS polish (index.css)**:
   - Verify all animation classes work smoothly (animate-in, glow-text, glow-box)
   - Add a subtle page transition: when route changes, content fades in (the animate-in class should already handle this via the existing CSS)
   - No new animations needed if existing ones work well — verify, don't over-engineer
  </action>
  <verify>
- Role switching in sidebar provides visual feedback (content updates feel smooth, not jarring)
- WorkflowPage empty states show helpful, role-specific guidance
- No layout shift or flicker during role switch
- Page transitions feel polished
- No console errors
  </verify>
  <done>Role switching feels smooth, empty states guide users, landing experience is polished for demo presentation</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete Phase 5: Role Switcher & Demo experience — global role switcher in sidebar, expanded demo data across all workflow states, contextual demo hints, polished transitions</what-built>
  <how-to-verify>
    1. Run: `npm run dev` (port 5180)
    2. Visit: http://localhost:5180/ecosform/
    3. **Role Switcher:** Check sidebar footer shows current employee/role. Click to expand, switch to each role type (employee, manager, admin). Verify the switch is instant and all page content updates.
    4. **Demo Banner:** Verify contextual hint appears at top of content area. Navigate between pages — hint should update. Dismiss and verify it stays hidden until role switch.
    5. **Employee View:** Switch to Alex Rivera (employee). Go to Agreement — see form. Go to Workflow — see their agreements.
    6. **Manager View:** Switch to Morgan Hayes (manager). Go to Workflow — see pending agreements waiting for manager signature. Sign one.
    7. **Admin View:** Switch to Casey Nguyen (admin). Go to Workflow — see agreements waiting for admin sign-off.
    8. **Mobile:** Resize to mobile width. Open hamburger menu. Verify role switcher appears in mobile nav footer.
    9. **Data Variety:** Check that each role sees multiple agreements in different states (not just 1-2).
    10. Confirm: Overall experience feels demo-ready — an executive could be walked through it and be impressed.
  </how-to-verify>
  <resume-signal>Type "approved" to complete Phase 5, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] Role switcher works globally (sidebar, both desktop and mobile)
- [ ] All 3 role perspectives show meaningful, varied content
- [ ] Demo hints guide non-technical users
- [ ] Transitions are smooth, no jank
- [ ] No console errors or warnings
- [ ] Phase 5 complete — demo experience is exec-presentation ready
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Human verification approved
- Demo experience is polished enough for executive presentations
- Phase 5 complete
</success_criteria>

<output>
After completion, create `.planning/phases/05-role-switcher-demo/05-03-SUMMARY.md`
</output>
